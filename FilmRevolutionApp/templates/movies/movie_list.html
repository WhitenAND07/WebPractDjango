{%  extends  "base.html" %}
    {%  block  content  %}
        <h1>
            Movies
            {%  if  user.is_authenticated  %}
                (<a  href="{%  url  'FilmRevolutionApp:movie_create'  %}">add</a>)
            {%  endif  %}
        </h1>
        <form  action="{%  url  'FilmRevolutionApp:review_movie_create'  movie.id  %}"  method="post">
            <input type="text" name="searcher">
        </form>
        <ul>
            {%  for  movie  in  latest_movie_list  %}
                <li>
                    <a  href="{%  url  'FilmRevolutionApp:movie_detail'  movie.id  %}"> {{  movie.title  }}
                    </a>
                </li>
            {%  empty  %}
                <li>Sorry,  no  movies  registered  yet.</li>
            {%  endfor  %}
        </ul>
    {%  endblock  %}
<script>
     $(function () {
         $("#id_searcher").autocomplete({
             source: function (request, response) {
                 $.ajax({
                     url: 'FilmRevolutionApp:'
                 })
             }
         })
     })
     $(function() {
            $.getJSON("{% static "countries.json" %}", {}, function (countries) {
                $("#id_country").autocomplete({
                    source: countries
                });
            });
            $("#id_city").autocomplete({
                source: function( request, response ) {
                    $.ajax({
                        url: "http://ws.geonames.org/searchJSON",
                        dataType: "jsonp",
                        data: {
                            featureClass: "P",
                            maxRows: 10,
                            name_startsWith: request.term,
                            username: "demo"
                        },
                        success: function( data ) {
                            response( $.map( data.geonames, function( item ) {
                                return {
                                    label: item.name + (item.adminName1 ? ", " + item.adminName1 : "") + ", " + item.countryName,
                                    value: item.name,
                                    stateOrProvince: item.adminName1,
                                    countryName: item.countryName
                                }
                            }));
                        }
                    });
                },
                minLength: 2,
                select: function( event, ui ) {
                    if (ui.item) {
                        $("#id_state").val(ui.item.stateOrProvince);
                        $("#id_country").val(ui.item.countryName);
                    }
                }
            });
        });
</script>